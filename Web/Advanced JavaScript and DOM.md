# Advanced JavaScript and DOM

### Events

事件处理器通过回调的方式处理事件

#### 观察者模式

主题发生状态/属性变化，通知观察者进行响应的操作。

##### 特征

主题和观察者之间解耦

广播通信

##### 需要注意的

可能造成内存泄漏。解除绑定时出现错误，可能造成主题中仍有观察者造成内存泄漏。

#### 原型库绑定

#### DOM 2 Event Types

UI 鼠标 页面状态（页面加载完…） 键盘相关

异步方式对变化进行响应。

#### H5 新事件

### Event handling models

#### DOM Level 0

一一对应的模式，直接简单

#### DOM Level 2

##### Event flow

事件从根元素向上传播到根节点。

捕获：从根节点到目标节点的父节点

目标节点阶段

冒泡阶段：事件从目标节点到父元素，再到根结点，冒泡

控制在哪个阶段进行处理

DOM 0 就是目标节点的阶段（类似）

职责链，事件的处理有一系列对象相关联。事件在链的结构进行传播，每个对象，如果有事件处理器就对对应事件进行处理，知道尾端。一种解耦合的方式。缺点在于，可能传播一遍没人处理。最后加上默认的处理

最后一个参数，true对应捕获阶段，false对应冒泡阶段

### Scope and Closure

#### 变量声明周期

从声明开始

函数内的，在函数创建时创建，结束是失效

全局变量，和当前页面相关

#### 闭包

类似于私有变量

匿名函数的方式

嵌套子函数能访问父函数变量，作用于外延

内部函数比外部函数具有更长生命周期

this动态类型。this永远指向全局的

保护命名空间。

有可能造成内存泄漏，长期驻留内存

#### Scope Chain

标识符解析，从Scope chain依次寻找，解析。作用域靠前的先找到。

调用全局变量，会遍历作用域链，效率比较低

with，改变作用域，插入作用域链的最前端。问题在与访问别的局部变量更慢了，整体性能下降。

由于闭包存在，活动对象销毁时，闭包仍持有其引用

## 作业

服务端 Node.js

以第一个作业为前端页面

服务端实现2类功能，登陆注册、图片视频的加载

需要注意，用一点数据库，用户信息保存于数据库，图片视频保存于文件系统